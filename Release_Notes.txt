
-------------------------------------------------------
Topaz Hypervisor Release Notes

Topaz Version: 0.3
Revsion: 0.3-rc3
Date: 10/10/2008

-------------------------------------------------------
Contents

1. Introduction
2. Compatibility/Dependencies
3. Detailed List of Changes
4. Limitations

-------------------------------------------------------
1.  Introduction

   This document identifies changes between Topaz 
   releases and a list of limitations.

-------------------------------------------------------
2.  Compatibility/Dependencies

   -Topaz 0.3-rc3
      -is compatible with P4080 4.0.20 / 4.0.pre5
      -the unit tests are not compatible with earlier versions
       of simics due a model change with respect to flash

   -in sync with Embedded Hypervisor Architecture specifciation
    0.81

-------------------------------------------------------
3.  Detailed List of Changes

   -Topaz 0.3-rc3 bug fixes and changes
      -L1 and L2 cache control register access is now
       supported (as per 0.81 Topaz spec)-- a few L2
       registers are still missing
      -TLB cache bug is fixed that resulted in segmentation
       faults in Linux
      -bug 2166 (TLB search not giving proper tsize for TLB0)
       is fixed
      -bug 2167 (Compilation error on changing PHYSMAPSIZE
        macro used in head.S) is fixed
      -bug 2152 - update to unit tests to run with new 
       Simics model
      -fix handling of multiple pending guest doorbells
      -sim.git is now a submodule of the hypervisor and
       will be used as basis for the unit tests-- u-boot
       and boot.simics will come from here

   -Topaz 0.3-rc2 bug fixes and changes
      -guest watchdog support is implemented (see limitations
       below)
      -libos and dts are now submodules and do not need to
       be cloned separately from the hypervisor
      -bug 2129-- hypervisor console not working on byte-channel
       on a mux

   -Topaz 0.3-rc1 bug fixes and changes from 0.2
      -guest cache lock mode is now supported as per
      the Topaz spec
      -TLB cache-- TLB0 and TLB1 are both fully virtualized
       (CONFIG_TLB_CACHE)
      -master and guest device printing support at the
       HV console
      -guest machine check cleanup and unit test
      -initial guest debug mode support-- trap instruction
       debug trap is implemented

-------------------------------------------------------
4.  Limitations

 A. Open Bugs

 B. CPU Feature Limitations

   -MMU
      -If the guest-to-real address mapping is sufficiently
       misaligned, TLB1 entries can be depleted, causing
       a hypervisor panic.

   -physical addresses greater than 32 bits are not supported

   -CPU core performance monitor support
      -support for the CPU performance interrupt is not implemented

   -CPU core Debug support
      -IAC,DAC,IRPT support is not present

   -guest watchdog does not support the partition management
    interrupts

   -Cache control
      -the following cache control registers are not implemented
         L1CSR2
         L2CAPTDATAHI
         L2CAPTDATALO
         L2CAPTECC
         L2CSR0
         L2CSR1
         L2ERRADDR
         L2ERRATTR
         L2ERRCTL
         L2ERRDET
         L2ERRDIS
         L2ERREADDR
         L2ERRINJCTL
         L2ERRINJHI
         L2ERRINJLO
         L2ERRINTEN

   -Power management
      -support for the MSR[WE] power management bit is not
       implemented

 C. p4080 Platform Features

   -Coherence subdomains
      -Support for coherence subdomains is not implemented.  All
       memory is globally coherent.

   -L3 / Platform Cache configuration is not implemented

   -platform error interrupts
      -In the platform MPIC multiple error interrupts are multiplexed
       to interrupt 0.  De-multiplexing and routing of platform
       error interrupts to partitions is not implemented.

 D. Configuration
   -the hypervisor must be loaded and run from physical address 0x0

 E. Hypervisor Services

   -Partition Management
      -Partition management interrupts (as specified in the
       Topaz spec) are not implemented:
         -partition state change 
         -watchdog expiration
         -restart request

   -Debug console
      -the hypervisor debug console is partially implemented
       and input is not supported

   -gdb stub
      -the gdb stub does not support hardware breakpoints or
       hardware watchpoints 
      -the stub is limited to debugging the boot core in 
       each partition.  SMP debugging is not supported.

 F. ePAPR Related Notes

    -The hypervisor does not currently comply with the ePAPR 
     ELF loading requirements with respect to the physical
     load address of the image.  The ET_EXEC and ET_DYN
     flags are ignored and guest images is loaded at the specified
     address address (fsl,hv-load-image-table property or 
     partman utility)
