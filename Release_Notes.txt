
-------------------------------------------------------
Topaz Hypervisor Release Notes

Topaz Version: 0.3
Revsion: 0.3-rc6
Date: 11/20/2008

-------------------------------------------------------
Contents

1. Introduction
2. Compatibility/Dependencies
3. Detailed List of Changes
4. Limitations

-------------------------------------------------------
1.  Introduction

   This document identifies changes between Topaz 
   releases and a list of limitations.

-------------------------------------------------------
2.  Compatibility/Dependencies

   -Topaz 0.3-rc6
      -is compatible with P4080 4.0.20 / 4.0.pre5 and later
       versions of Simics

   -in sync with Embedded Hypervisor Architecture specifciation
    0.82

-------------------------------------------------------
3.  Detailed List of Changes

   -Topaz 0.3-rc6 bug fixes and changes
      -added I2C controller virtualization
      -do not set interrupts to critical before they are registered--
       fixes a problem where pending UART interrupts fired before
       a handler was registered
      -improved readability of shell 'paact' command output
      -livetree integration-- no user visibile change from this, this
       is groundwork for the upcoming new partition definition
       change 
      -removed obsolete ppid-to-liodn hcall

   -Topaz 0.3-rc5 bug fixes and changes
      -support for loading uncompressed uImages from partman
      -fixed bug 2165-- watchdog unit test hangs after rebooting once
      -guest debug mode emulation -- support for IAC and DAC
      -removed CONFIG_IPI_DOORBELL option
      -libos-- clear MSR after fixup_mmu()

   -Topaz 0.3-rc4 bug fixes and changes
      -support for loading uncompressed uImages for client program
       images and ramdisk
      -Bug 2121 is fixed. write_gmsr: mask out privileged bits
      -Bug 2196 is fixed.  ISI interrupt comes when use TLB0
       and machine check when TLB1.
      -guest debug mode: add support for ICMP guest debug event
      -support the partition management interrupts
         Note: the 0.81 spec does not have these documented
         currently
      -support the fsl,hv-wd-mgr-notify property which specifies
       that watchdog timeouts should signal the manager
       partition
      -all L2 cache control registers are now supported
      -Bug 2169 is fixed. Set valid bit in tlbcache tag from MAS1,
       rather than always 1.
      -partman now supports copying ELF images with
       discontiguous load segments
      -hypervisor now catches machine checks and dumps
       errors
      -support building the hypervisor out of tree with the
       O= option on the make command line.  By default all
       objects produced by the build go into the output
       directory

   -Topaz 0.3-rc3 bug fixes and changes
      -L1 and L2 cache control register access is now
       supported (as per 0.81 Topaz spec)-- a few L2
       registers are still missing
      -TLB cache bug is fixed that resulted in segmentation
       faults in Linux
      -bug 2166 (TLB search not giving proper tsize for TLB0)
       is fixed
      -bug 2167 (Compilation error on changing PHYSMAPSIZE
        macro used in head.S) is fixed
      -bug 2152 - update to unit tests to run with new 
       Simics model
      -fix handling of multiple pending guest doorbells
      -sim.git is now a submodule of the hypervisor and
       will be used as basis for the unit tests-- u-boot
       and boot.simics will come from here

   -Topaz 0.3-rc2 bug fixes and changes
      -guest watchdog support is implemented (see limitations
       below)
      -libos and dts are now submodules and do not need to
       be cloned separately from the hypervisor
      -bug 2129-- hypervisor console not working on byte-channel
       on a mux

   -Topaz 0.3-rc1 bug fixes and changes from 0.2
      -guest cache lock mode is now supported as per
      the Topaz spec
      -TLB cache-- TLB0 and TLB1 are both fully virtualized
       (CONFIG_TLB_CACHE)
      -master and guest device printing support at the
       HV console
      -guest machine check cleanup and unit test
      -initial guest debug mode support-- trap instruction
       debug trap is implemented

-------------------------------------------------------
4.  Limitations

 A. Open Bugs

 B. CPU Feature Limitations

   -MMU
      -If the guest-to-real address mapping is sufficiently
       misaligned, TLB1 entries can be depleted, causing
       a hypervisor panic.

   -physical addresses greater than 32 bits are not supported

   -CPU core performance monitor support
      -support for the CPU performance interrupt is not implemented

   -Power management
      -support for the MSR[WE] power management bit is not
       implemented

 C. p4080 Platform Features

   -Coherence subdomains
      -Support for coherence subdomains is not implemented.  All
       memory is globally coherent.

   -L3 / Platform Cache configuration is not implemented

   -platform error interrupts
      -In the platform MPIC multiple error interrupts are multiplexed
       to interrupt 0.  De-multiplexing and routing of platform
       error interrupts to partitions is not implemented.

 D. Configuration
   -the hypervisor must be loaded and run from physical address 0x0

 E. Hypervisor Services

   -gdb stub
      -the gdb stub does not support hardware breakpoints or
       hardware watchpoints 
      -the stub is limited to debugging the boot core in 
       each partition.  SMP debugging is not supported.

 F. ePAPR Related Notes

    -The hypervisor does not currently comply with the ePAPR 
     ELF loading requirements with respect to the physical
     load address of the image.  The ET_EXEC and ET_DYN
     flags are ignored and guest images is loaded at the specified
     address address (fsl,hv-load-image-table property or 
     partman utility)
